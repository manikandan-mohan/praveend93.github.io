<!DOCTYPE html>
<html>

	
	    <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
    <meta content="A declarative statistics visualization library" name="description">
  
  
    <meta name="keywords" content="Visualization,Data Science">
  
  <meta name="author" content="Karthik">

  <title>
    
        Karthik Balasubramanian|A Visualization tutorial
    
  </title>
  <!-- favicon -->
  <link rel="shortcut icon" href="//static/img/brain.ico">

  <!-- Third-party CSS -->
  <link href="/bower_components/normalize-css/normalize.min.css" rel="stylesheet">
  <link href="/bower_components/bootstrap/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="/bower_components/animate.css/animate.min.css" rel="stylesheet">
  <link href="/bower_components/components-font-awesome/css/font-awesome.min.css" rel="stylesheet">
  <link href="/static/font-mfizz/font-mfizz.css" rel="stylesheet">
  <!-- <link href="/bower_components/toastr/toastr.min.css" rel="stylesheet"> -->
  <link href="/bower_components/jquery.gritter/css/jquery.gritter.css" rel="stylesheet">
  <link rel="stylesheet" href="//search/css/cb-search.css">

  <!-- Custom styles for this template -->
  <link href="/static/css/style.min.css" rel="stylesheet">
  <link href="/static/css/pygments.css" rel="stylesheet">

  <!-- Scripts -->
  <script src="/bower_components/jquery/dist/jquery.min.js"></script>
  <script src="/search/js/bootstrap3-typeahead.min.js"></script>

  <!-- cb-search -->
  <script src="/search/js/cb-search.js"></script>
  <script>
    $(function(){
        $("pre").css('display','block');
    });
  </script>
  <!-- Mainly scripts -->
  <script src="/bower_components/bootstrap/dist/js/bootstrap.min.js"></script>
  <script src="/bower_components/metisMenu/dist/metisMenu.min.js"></script>
  <script src="/bower_components/jquery-slimscroll/jquery.slimscroll.min.js"></script>

  <!-- Peity -->
  <script src="/bower_components/peity/jquery.peity.min.js"></script>

  <script src="/bower_components/PACE/pace.min.js"></script>
  <script src="/bower_components/wow/dist/wow.min.js"></script>
  <!-- Custom and plugin javascript -->
  <script src="/static/js/inspinia.js"></script>

  <!-- Rickshaw -->
  <script src="/bower_components/rickshaw/vendor/d3.v3.js"></script>
  <script src="/bower_components/rickshaw/rickshaw.min.js"></script>


  <!-- jPages -->
  <script src="/static/js/jPages.js"></script>
  <script src="/static/js/js.js"></script>
  <script id="dsq-count-scr" src="//https-karthikbalasubramanian-github-io.disqus.com/count.js" async></script>
  <script type="text/javascript">
        $(function(){
          /* initiate the plugin */
          $("div.pag-holder").jPages({
              containerID  : "pag-itemContainer",
              perPage      : 5,  /* num of items per page */
              startPage    : 1,
              startRange   : 1,
              midRange     : 3,
              endRange     : 1
          });
      });
  </script>

<!-- GrowingIO -->


</head>

	


<body id="page-top" class="landing-page">

	
	    <div class="search-tool"
      style="position: fixed; top: 0px ; bottom: 0px; left: 0px; right:  0px; opacity: 0.95; background-color: #111111; z-index: 9999; display: none;">
    <input type="text" class="form-control search-content" id="search-content" style="position: fixed; top: 60px" placeholder="Search Blog">

    <div style="position: fixed; top: 16px; right: 16px; z-index: 9999;">
        <img src="/search/img/cb-close.png" id="close-btn"/>
    </div>
</div>

<div style="position: fixed; right: 16px; bottom: 20px; z-index: 9999;">
    <img src="/search/img/cb-search.png"  id="search-btn"  title="Double click Ctrl"/>
</div>

<div class="navbar-wrapper">
        <nav class="navbar navbar-default navbar-fixed-top" role="navigation">
            <div class="container">
                <div class="navbar-header page-scroll">
                    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    <a class="navbar-brand" href="/">Karthik Balasubramanian</a>
                </div>
                <div id="navbar" class="navbar-collapse collapse">
                    <ul class="nav navbar-nav navbar-right">
                        <li><a class="page-scroll" href="/blog/"></a></li>
                        
                            
                            <li>
                            
                            <a class="page-scroll" href="/blog/">blog</a></li>
                        
                            
                            <li>
                            
                            <a class="page-scroll" href="/ml/">Data Science</a></li>
                        
                            
                            <li>
                            
                            <a class="page-scroll" href="/algorithms/">algorithms</a></li>
                        
                            
                            <li>
                            
                            <a class="page-scroll" href="/life/">life</a></li>
                        
                            
                            <li>
                            
                            <a class="page-scroll" href="/writing/">writing</a></li>
                        
                    </ul>
                </div>
            </div>
        </nav>
</div>
<div id="inSlider" class="carousel carousel-fade" data-ride="carousel">
    <ol class="carousel-indicators">
        <li data-target="#inSlider" data-slide-to="0" class="active"></li>
        <li data-target="#inSlider" data-slide-to="1"></li>
    </ol>
    <div class="carousel-inner" role="listbox">
        <div class="item active">
            <div class="container">
                <div class="carousel-caption">
                </div>
                <div class="carousel-image wow zoomIn">
                    <!-- <img src="static/img/landing/laptop.png" alt="laptop"/> -->
                </div>
            </div>
            <!-- Set background for slide in css -->
            <div class="header-back one"></div>

        </div>
        <div class="item">
            <div class="container">
                <div class="carousel-caption blank">
                </div>
            </div>
            <!-- Set background for slide in css -->
            <div class="header-back two"></div>
        </div>
    </div>
    <a class="left carousel-control" href="#inSlider" role="button" data-slide="prev">
        <span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>
        <span class="sr-only">Previous</span>
    </a>
    <a class="right carousel-control" href="#inSlider" role="button" data-slide="next">
        <span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span>
        <span class="sr-only">Next</span>
    </a>
</div>

	

    <div class="wrapper wrapper-content  animated fadeInRight article">
    <div class="row">
        <div class="col-lg-10 col-lg-offset-1">
            <div class="ibox">
                <div class="ibox-content">
                    <div class="pull-right">
                    	
                        	<button class="btn btn-white btn-xs" type="button">Ml</button>
                        
                    </div>
                    <div class="text-center article-title">
                    <span class="text-muted"><i class="fa fa-clock-o"></i> 20 Jan 2017</span>
                        <h1>
                            A Visualization tutorial
                        </h1>
                    </div>
                    	<h1 id="altair-viz">Altair Viz</h1>

<h2 id="motivation">Motivation:</h2>

<p>There were so many visualization libraries in Python. <strong>MatplotLib</strong>,<strong>Seaborn</strong>,<strong>Plotly</strong>, <strong>Bokeh</strong>,   <strong>Lightning</strong>,<strong>Pandas</strong> are some of the options a user can have while trying to visualize. Every library has its   own ups and downs and the tool that we use to visualize largely depends on our need. All these APIs for visualization are inspired from the Principles of <a href="http://vita.had.co.nz/papers/layered-grammar.pdf">Wilkinson’s grammar of   graphics</a>. Many users use different libraries these days to try to visualize their data in Jupyter Notebook. At times we go through problems which are still not addressed by the developers of individual visualisation libraries. So <a href="https://github.com/jakevdp/altair/tree/master/doc">Jake Vanderplas</a> and <a href="https://github.com/ellisonbg">Brian Granger</a> of <strong>IPython project</strong> decided to address generic API solution and that’s how they started <a href="https://github.com/ellisonbg/altair">Altair Viz</a> project. This is a completely new library but I believe that it has lot to offer for the IPython community.</p>

<h2 id="visualization-is-pain-in-python-lets-breakdown-this-problem">Visualization is pain in Python! Lets breakdown this problem</h2>

<p>Lets all accept this fact. I have used tableau, Excel, R. Visualization with these tools are really easy because they have easy drag and drop options. Whereas we have to understand lot of syntax and semantics to use a visualization library in python. I completely agree that we cannot custom visualize a very large dataset in Excel/ tableau as it eats up all the RAM and slows down our system. So libraries like these are the only scalable solution for visualizing large datasets. Lets first list down the drawbacks of the visualization libraries in Python.</p>

<ol>
  <li>Sparse handling of statistical visualization</li>
  <li>User have to write lots of code even for incidental aspects of visualization.</li>
  <li>Its becoming really difficult for users to decide on which library to use. There is a lot of learning curve to go through as a new library is introduced into the community.</li>
  <li>Most basic things are horribly complicated (Even the developers of Altair Viz agree)</li>
</ol>

<h3 id="components-of--statistical-visualization">Components of  Statistical Visualization</h3>

<p>There are three components in Statistical Visualization:</p>

<ol>
  <li>The <strong>data</strong> (How and what part). Data is generally represented as tidy dataframes with rows being the samples and columns being features (Categorical or numerical/timeseries data)</li>
  <li>This tidy data is mapped to <strong>visual properties</strong> like x axis, y axis, color and shape using groupby operation</li>
  <li><strong>Groups</strong> correspond to conditional probability distribution</li>
</ol>

<h3 id="what-is-the-visualization-grammar-to-follow">What is the Visualization Grammar to follow?</h3>

<p>It is very important to have a set of well-defined rules that devise a set of abstractions while visualizing data. It’ll be very nice to express the Statistical Visualization with a small number of abstractions. These abstractions form a Visualization Grammar. These abstractions are defined so that a model can be reused again. We have different levels of abstractions. But not all the visualization library present today follow strictly.</p>

<p><a href="https://postimg.org/image/7ssyuahjx/"><img src="https://s6.postimg.org/8v35cu0dd/Grammar.png" alt="Grammar.png" /></a></p>

<p>Developers of Altair Viz claim that most of the libraries follow all these rules. But they lack in two of the rules in the ruleset.</p>

<ol>
  <li>
    <p><strong>Transformation</strong>:
 We beleive that transformation of data happens before visualization. But when we do Statistical visualization, it is really difficult to do the data transformation before the visualization is done. We really have to develop a data transformation pipeline into the visualization process itself.</p>
  </li>
  <li>
    <p><strong>Scaling</strong>:
 Scaling is nothing but mapping the transformed tidy data values to visualization properties like shapes, colors and facets (plane or axis). This mapping is incomplete in the current libraries. This is where most of the libraries lack representations. Libraries like Matplotlibs can map quantitative columns with visual properties but they lack representation for categorical and timeseries data.</p>
  </li>
</ol>

<h2 id="types-of-api">Types of API</h2>

<p>There are two types of APIs generally. Declarative and Imperative APIs.</p>

<h3 id="comparison-between-declarative-and-imperative-api">Comparison between Declarative and imperative API</h3>

<p>The following table compares both types of APIs</p>

<p><a href="https://postimg.org/image/3zfn2rtjx/"><img src="https://s6.postimg.org/6grea1dgh/Compare.png" alt="Compare.png" /></a></p>

<h3 id="why-declarative-api-is-better">Why Declarative API is better?</h3>

<p>Lets assume that you are building a decision tree. At each node level you would like determine the attribute that best classifies the dataset. To identify the attribute you will have to undergo a statistical test like <strong>information gain</strong> on each attribute and decide the best. But this process is error prone. We humans do lots of mistakes while doing such calculations and its a horror story to debug a multilevel decision tree when something goes wrong in these calculations. You know that you are capable of doing these math. Do you want to prove it each and every time??</p>

<p>Given a magic function which does this mundane statistical property math forever <strong>correctly</strong> as you pass the parameters, wont you prefer that over writing the function yourself?</p>

<p><a href="https://postimg.org/image/o830ohsv1/"><img src="https://s6.postimg.org/jyyambplt/why_dec.png" alt="why_dec.png" /></a></p>

<h2 id="mapping-visualization-apis-according-to-its-characteristics">Mapping Visualization APIs according to its characteristics</h2>

<p>Now lets concentrate on the space of visualisation libraries. The below image compares declarative and imperative viz libraries with two other important characteristics. <strong>Ease of use</strong> and  <strong>representational power</strong>.</p>

<p><a href="https://postimg.org/image/h6532ap99/"><img src="https://s6.postimg.org/5h13ebyap/map_viz.png" alt="map_viz.png" /></a></p>

<h2 id="introducting-altair-viz-api">Introducting Altair Viz API</h2>

<p>You may be wondering why Altair Viz is not there in the Declarative API section of the previous image. Atleast I have been telling you so far that Altair viz is a statistical visualization library.</p>

<p>But!</p>

<p>Let me confess you a truth. Altair is not fully a vizualization library because it does not do any rendering of visulaizations.</p>

<p><a href="https://postimg.org/image/tyewq33a5/"><img src="https://s6.postimg.org/tlnijwl0h/Altair_Flow.png" alt="Altair Flow.png" /></a></p>

<p>We all know <a href="https://d3js.org/">D3.js</a> renders rich visualizations. But it is verbose. We need to write lots of code to render even a simple <a href="http://d3-generator.com/">bar chart</a>. <a href="https://vega.github.io/vega/">Vega</a> is a visualization grammar.It is a declarative format for creating and sharing interactive visualization designs which is built on D3.It is again verbose. Simple implementation of bar chart in <a href="http://vega.github.io/vega-editor/index.html?spec=bar">Vega</a>. <a href="https://vega.github.io/vega-lite/">Vega-lite</a> is a high-level visualization grammar. It provides a concise JSON syntax for supporting rapid generation of visualizations to support analysis. It is strictly for declarative statistical visualizations.Check how well it simplifies the visualization of bar chart <a href="https://vega.github.io/vega-editor/?mode=vega-lite&amp;spec=bar">here</a></p>

<p>Developers of Altair-Viz did not try to re-invent the wheel. They wanted to utilise this powerful visualisation grammar which abstracts all the complexity of visualisation. So they created a Python API which emits <strong>type-checked JSON</strong> which is sent down to Vega-lite which inturn is interpreted by Vega and visualised by D3. This integration is well appreciated by all other viz library developer community like Matplotlib and they are also planning to create an API like Altair Viz so that Vega/Vega-lite become the lingua-franca of data visualisation</p>

<h2 id="how-altair-viz-makes-your-life-easier">How Altair Viz makes your life easier?</h2>

<p>Before we start, we should install Altair viz.</p>

<p><code class="highlighter-rouge">conda install altair --channel conda-forge</code></p>

<p>To do statistical visualization, you should have 3 distinct components working together. Let’s understand these components syntax seperately.</p>

<ul>
  <li>Data</li>
  <li>Visual properties</li>
  <li>Transformation/Grouping</li>
</ul>

<h4 id="data">Data</h4>

<p>The data that we generally visualize is a tidy dataframe. This can be your pandas dataframe.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s">'a'</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="s">'AABCCDDEE'</span><span class="p">),</span>
                     <span class="s">'b'</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">]})</span>
<span class="n">data</span>
</code></pre></div></div>

<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>a</th>
      <th>b</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>A</td>
      <td>2</td>
    </tr>
    <tr>
      <th>1</th>
      <td>A</td>
      <td>7</td>
    </tr>
    <tr>
      <th>2</th>
      <td>B</td>
      <td>4</td>
    </tr>
    <tr>
      <th>3</th>
      <td>C</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>C</td>
      <td>2</td>
    </tr>
    <tr>
      <th>5</th>
      <td>D</td>
      <td>6</td>
    </tr>
    <tr>
      <th>6</th>
      <td>D</td>
      <td>8</td>
    </tr>
    <tr>
      <th>7</th>
      <td>E</td>
      <td>4</td>
    </tr>
    <tr>
      <th>8</th>
      <td>E</td>
      <td>7</td>
    </tr>
  </tbody>
</table>
</div>

<h4 id="visual-properties">Visual properties</h4>

<p>The visual properties of data are defined in the <strong>Chart</strong> object. Chart object has variety of functions which can be applied on a dataframe when passed. It can also directly take in a JSON object. Once you load the data into Chart object, you will define the visual properties. Consider it like a pipeline and follow the instructions one after another.</p>

<ol>
  <li>Define the kind chart you want to draw</li>
  <li>Define visual properties like Axis and color</li>
  <li>Define grouping functions</li>
</ol>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">altair</span> <span class="kn">import</span> <span class="n">Chart</span>

<span class="n">chart</span> <span class="o">=</span> <span class="n">Chart</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">chart</span>
</code></pre></div></div>

<div class="vega-embed" id="05e06b9c-6424-4736-a95e-d9176b6aa838"></div>

<style>
.vega-embed svg, .vega-embed canvas {
  border: 1px dotted gray;
}

.vega-embed .vega-actions a {
  margin-right: 6px;
}
</style>

<p><a href="https://postimg.org/image/e3qn2klst/"><img src="https://s6.postimg.org/yb42uvja9/output_8_2.png" alt="output_8_2.png" /></a></p>

<p>You can see that the chart object has already visualized the data before even you define its visual properties. What you can infer from this chart is that, All the rows in the dataframe overlap over one another with a default mark type called <strong>mark_point</strong>. Now lets add Visual properties to it</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">altair</span> <span class="kn">import</span> <span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">Axis</span>

<span class="n">chart</span><span class="o">.</span><span class="n">mark_bar</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s">'#c70d08'</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
  <span class="n">X</span><span class="p">(</span><span class="s">'a'</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="n">Axis</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s">'Category'</span><span class="p">)),</span>
  <span class="n">Y</span><span class="p">(</span><span class="s">'b'</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="n">Axis</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s">'Count'</span><span class="p">)),</span>
<span class="p">)</span>
<span class="n">chart</span>

</code></pre></div></div>

<div class="vega-embed" id="3c06c980-f73e-443e-8a09-03630c78dfe8"></div>

<style>
.vega-embed svg, .vega-embed canvas {
  border: 1px dotted gray;
}

.vega-embed .vega-actions a {
  margin-right: 6px;
}
</style>

<p><a href="https://postimg.org/image/a8n9002n1/"><img src="https://s6.postimg.org/r9658ofoh/output_10_2.png" alt="output_10_2.png" /></a></p>

<p>That was so simple! The Chart object has many mark functions which lets you define the kind of chart to be drawn. Play around with the <a href="https://altair-viz.github.io/API.html#altair.Chart.mark_area">options</a>. You can define properties like color of the chart inside the ‘mark_’ function. <strong>‘#c70d08’</strong> is an example color code. You can set your own color code from <a href="http://www.color-hex.com/">here</a>. Whatever you define inside the encode are called Channels and they are python classes themselves with init attributes. you can find more details about encoding channels <a href="https://altair-viz.github.io/documentation/encoding.html">here</a>.There are different types of encoding channels. Classes X,Y are called position encoding channels. In the last link, you have an example implementation of most of the channel types.</p>

<p>You have to notice the links to <strong>Vega editor</strong> and <strong>View Source</strong> above. As you click those links you can understand how your chart definitions is transformed to type-checked Vega grammar which is sent to D3 to visualize.</p>

<p>Another important functionality of Altair is automatic data type interpretation. We did not specify datatype of the Axis. Altair intelligently interprets the type of data and emits out the data according to its type. But you can always specify datatype. Altair classifies data into four types.</p>

<table>
  <thead>
    <tr>
      <th>Data type</th>
      <th>Shorthand code</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>quantitative</td>
      <td>Q</td>
      <td>a continuous real-valued quantity</td>
    </tr>
    <tr>
      <td>ordinal</td>
      <td>O</td>
      <td>a discrete ordered quantity</td>
    </tr>
    <tr>
      <td>nominal</td>
      <td>N</td>
      <td>a discrete unordered category</td>
    </tr>
    <tr>
      <td>temporal</td>
      <td>T</td>
      <td>a time or date value</td>
    </tr>
  </tbody>
</table>

<p>So you can also define the Chart this way.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">chart</span><span class="o">.</span><span class="n">mark_bar</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s">'#c70d08'</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
  <span class="n">X</span><span class="p">(</span><span class="s">'a:N'</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="n">Axis</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s">'Category'</span><span class="p">)),</span>
  <span class="n">Y</span><span class="p">(</span><span class="s">'b:Q'</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="n">Axis</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s">'Count'</span><span class="p">)),</span>
<span class="p">)</span>
<span class="n">chart</span>
</code></pre></div></div>

<div class="vega-embed" id="3ba946fc-d3c2-45a5-a4f7-eb4f7a4baab1"></div>

<style>
.vega-embed svg, .vega-embed canvas {
  border: 1px dotted gray;
}

.vega-embed .vega-actions a {
  margin-right: 6px;
}
</style>

<p><a href="https://postimg.org/image/w93lgmlb1/"><img src="https://s6.postimg.org/y0wkbj4o1/output_12_2.png" alt="output_12_2.png" /></a></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">chart</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{'config': {'mark': {'color': u'#c70d08'}},
 'encoding': {'x': {'axis': {'title': u'Category'},
   'field': u'a',
   'type': 'nominal'},
  'y': {'axis': {'title': u'Count'}, 'field': u'b', 'type': 'quantitative'}},
 'mark': 'bar'}
</code></pre></div></div>

<p>The chart you deined can be converted to dictionary and its visual properties can be understood. Lets see a bit more fancy chart now. For simplicity I am going to use the datasets that are pre-defined in Altair. Datasets are in JSON format and they can be loaded directly. We can also use <strong>load_dataset</strong> function to get the dataframe version of the dataset.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># in-built data sets</span>
<span class="kn">from</span> <span class="nn">altair.datasets</span> <span class="kn">import</span> <span class="n">list_datasets</span>
<span class="n">list_datasets</span><span class="p">()</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[u'flights-3m',
 u'weather',
 u'crimea',
 u'us-10m',
 u'driving',
 u'sf-temps',
 u'flights-5k',
 u'flights-20k',
 u'barley',
 u'miserables',
 u'birdstrikes',
 u'sp500',
 u'world-110m',
 u'monarchs',
 u'seattle-temps',
 u'jobs',
 u'cars',
 u'weball26',
 u'flights-2k',
 u'seattle-weather',
 u'gapminder-health-income',
 u'anscombe',
 u'unemployment-across-industries',
 u'stocks',
 u'population',
 u'iris',
 u'climate',
 u'github',
 u'airports',
 u'countries',
 u'flare',
 u'burtin',
 u'budget',
 u'flights-10k',
 u'flights-airport',
 u'movies',
 u'points',
 u'wheat',
 u'budgets',
 u'gapminder']
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">altair</span> <span class="kn">import</span> <span class="n">load_dataset</span><span class="p">,</span><span class="n">Color</span><span class="p">,</span><span class="n">Scale</span><span class="p">,</span><span class="n">SortField</span><span class="p">,</span><span class="n">Row</span><span class="p">,</span><span class="n">Column</span>

<span class="n">car_data</span> <span class="o">=</span> <span class="n">load_dataset</span><span class="p">(</span><span class="s">'cars'</span><span class="p">)</span>
<span class="n">car_data</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</code></pre></div></div>

<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Acceleration</th>
      <th>Cylinders</th>
      <th>Displacement</th>
      <th>Horsepower</th>
      <th>Miles_per_Gallon</th>
      <th>Name</th>
      <th>Origin</th>
      <th>Weight_in_lbs</th>
      <th>Year</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>12.0</td>
      <td>8</td>
      <td>307.0</td>
      <td>130.0</td>
      <td>18.0</td>
      <td>chevrolet chevelle malibu</td>
      <td>USA</td>
      <td>3504</td>
      <td>1970-01-01</td>
    </tr>
    <tr>
      <th>1</th>
      <td>11.5</td>
      <td>8</td>
      <td>350.0</td>
      <td>165.0</td>
      <td>15.0</td>
      <td>buick skylark 320</td>
      <td>USA</td>
      <td>3693</td>
      <td>1970-01-01</td>
    </tr>
    <tr>
      <th>2</th>
      <td>11.0</td>
      <td>8</td>
      <td>318.0</td>
      <td>150.0</td>
      <td>18.0</td>
      <td>plymouth satellite</td>
      <td>USA</td>
      <td>3436</td>
      <td>1970-01-01</td>
    </tr>
    <tr>
      <th>3</th>
      <td>12.0</td>
      <td>8</td>
      <td>304.0</td>
      <td>150.0</td>
      <td>16.0</td>
      <td>amc rebel sst</td>
      <td>USA</td>
      <td>3433</td>
      <td>1970-01-01</td>
    </tr>
    <tr>
      <th>4</th>
      <td>10.5</td>
      <td>8</td>
      <td>302.0</td>
      <td>140.0</td>
      <td>17.0</td>
      <td>ford torino</td>
      <td>USA</td>
      <td>3449</td>
      <td>1970-01-01</td>
    </tr>
  </tbody>
</table>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">car_Chart</span> <span class="o">=</span> <span class="n">Chart</span><span class="p">(</span><span class="n">car_data</span><span class="p">)</span><span class="o">.</span><span class="n">mark_circle</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
<span class="n">X</span><span class="p">(</span><span class="s">'Horsepower'</span><span class="p">,</span><span class="n">axis</span> <span class="o">=</span> <span class="n">Axis</span><span class="p">(</span><span class="n">title</span> <span class="o">=</span> <span class="s">'Horsepower'</span><span class="p">)),</span>
    <span class="n">Y</span><span class="p">(</span><span class="s">'Miles_per_Gallon'</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="n">Axis</span><span class="p">(</span><span class="n">title</span> <span class="o">=</span><span class="s">'Miles per Gallon'</span><span class="p">)),</span>
    <span class="n">Color</span><span class="p">(</span><span class="s">'Cylinders'</span><span class="p">)</span>
<span class="p">)</span>
<span class="n">car_Chart</span>
</code></pre></div></div>

<div class="vega-embed" id="0b8ec450-f6aa-410f-8e14-c0240087c70a"></div>

<style>
.vega-embed svg, .vega-embed canvas {
  border: 1px dotted gray;
}

.vega-embed .vega-actions a {
  margin-right: 6px;
}
</style>

<p><a href="https://postimg.org/image/wn9ityusd/"><img src="https://s6.postimg.org/4n5f9orc1/output_17_2.png" alt="output_17_2.png" /></a></p>

<p>We generally know that cars with more horsepower gives less mileage. Does increasing the number of cylinders in the engine impact the mileage per gallon? See for yourself! Fancy right? :) Can we do better?</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">car_Chart</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{'encoding': {'color': {'field': u'Cylinders', 'type': 'quantitative'},
  'x': {'axis': {'title': u'Horsepower'},
   'field': u'Horsepower',
   'type': 'quantitative'},
  'y': {'axis': {'title': u'Miles per Gallon'},
   'field': u'Miles_per_Gallon',
   'type': 'quantitative'}},
 'mark': 'circle'}
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s">'''We see that Cylinders are of quantitative type.
   But from our prior knowledge we know that the cylinders in a car don't
   max out over a range and they can be considered as categorical data types.
   Lets try overriding Altair's data type interpretation.'''</span>

<span class="n">car_Chart</span> <span class="o">=</span> <span class="n">Chart</span><span class="p">(</span><span class="n">car_data</span><span class="p">)</span><span class="o">.</span><span class="n">mark_circle</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
<span class="n">X</span><span class="p">(</span><span class="s">'Horsepower'</span><span class="p">,</span><span class="n">axis</span> <span class="o">=</span> <span class="n">Axis</span><span class="p">(</span><span class="n">title</span> <span class="o">=</span> <span class="s">'Horsepower'</span><span class="p">)),</span>
    <span class="n">Y</span><span class="p">(</span><span class="s">'Miles_per_Gallon'</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="n">Axis</span><span class="p">(</span><span class="n">title</span> <span class="o">=</span><span class="s">'Miles per Gallon'</span><span class="p">)),</span>
    <span class="n">Color</span><span class="p">(</span><span class="s">'Cylinders:N'</span><span class="p">)</span>
<span class="p">)</span>
<span class="n">car_Chart</span>
</code></pre></div></div>

<div class="vega-embed" id="65a00071-2a55-456b-9d70-cc02c74a22ec"></div>

<style>
.vega-embed svg, .vega-embed canvas {
  border: 1px dotted gray;
}

.vega-embed .vega-actions a {
  margin-right: 6px;
}
</style>

<p><a href="https://postimg.org/image/djg7dmhy5/"><img src="https://s6.postimg.org/py2zdy9gh/output_20_2.png" alt="output_20_2.png" /></a></p>

<p>Let me introduce some helper functions before we go over the next example:</p>

<table>
  <thead>
    <tr>
      <th>Shorthand</th>
      <th>Equivalent long-form</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>x=’name’</td>
      <td>X(‘name’)</td>
    </tr>
    <tr>
      <td>x=’name:Q’</td>
      <td>X(‘name’, type=’quantitative’)</td>
    </tr>
    <tr>
      <td>x=’sum(name)’</td>
      <td>X(‘name’, aggregate=’sum’)</td>
    </tr>
    <tr>
      <td>x=’sum(name):Q’</td>
      <td>X(‘name’, aggregate=’sum’, type=’quantitative’)</td>
    </tr>
  </tbody>
</table>

<h5 id="sortfield">SortField()</h5>
<p>If the encoding channel (i.e X,Y,Row,Column) has a continuous scale (Numerical) we can sort them directly. The default sorting order is <em>Ascending</em>.
  If the encoding channel is ordinal then we can use another encoding channel field to sort as a sort definition object. More about this can be found <a href="http://vega.github.io/vega-lite/docs/sort.html">here</a></p>

<h4 id="sort">Sort</h4>

<p>For continuous variable Reverse and ascending order</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Chart</span><span class="p">(</span><span class="n">car_data</span><span class="p">)</span><span class="o">.</span><span class="n">mark_tick</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">X</span><span class="p">(</span><span class="s">'Horsepower'</span><span class="p">,</span><span class="n">sort</span><span class="o">=</span><span class="s">'descending'</span><span class="p">),</span>
<span class="p">)</span>

<span class="c"># try this for ascending</span>
<span class="c"># Chart(car_data).mark_tick().encode(</span>
<span class="c">#     X('Horsepower'),</span>
<span class="c"># )</span>

</code></pre></div></div>

<div class="vega-embed" id="e058eed1-b28e-4cee-b92f-49cfc55b2028"></div>

<style>
.vega-embed svg, .vega-embed canvas {
  border: 1px dotted gray;
}

.vega-embed .vega-actions a {
  margin-right: 6px;
}
</style>

<p><a href="https://postimg.org/image/8m2msifz1/"><img src="https://s6.postimg.org/lq875780x/output_23_2.png" alt="output_23_2.png" /></a></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># lets try sorting a categorical variable</span>
<span class="n">Chart</span><span class="p">(</span><span class="n">car_data</span><span class="p">)</span><span class="o">.</span><span class="n">mark_tick</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">X</span><span class="p">(</span><span class="s">'Origin'</span><span class="p">,</span><span class="n">sort</span><span class="o">=</span><span class="s">'descending'</span><span class="p">),</span>
<span class="p">)</span>
<span class="c">## You could see that it got sorted by the precedence of alphabet. Now lets try to sort with</span>
<span class="c">## another field or by specifying an operation on same field</span>
</code></pre></div></div>

<div class="vega-embed" id="f9616941-8e9c-45d9-bb5b-679f1b6833ce"></div>

<style>
.vega-embed svg, .vega-embed canvas {
  border: 1px dotted gray;
}

.vega-embed .vega-actions a {
  margin-right: 6px;
}
</style>

<p><a href="https://postimg.org/image/vot5rohgd/"><img src="https://s6.postimg.org/mh0xazae9/output_24_2.png" alt="output_24_2.png" /></a></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Chart</span><span class="p">(</span><span class="n">car_data</span><span class="p">)</span><span class="o">.</span><span class="n">mark_tick</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">X</span><span class="p">(</span><span class="s">'Origin'</span><span class="p">,</span>
      <span class="n">sort</span><span class="o">=</span><span class="n">SortField</span><span class="p">(</span><span class="n">field</span><span class="o">=</span><span class="s">'Origin'</span><span class="p">,</span> <span class="n">op</span><span class="o">=</span><span class="s">'count'</span><span class="p">),),</span>
<span class="p">)</span>
<span class="c">## Sort based on the number of cars from each origin</span>
<span class="c">## now lets put things together in the next problem</span>
</code></pre></div></div>

<div class="vega-embed" id="e0f01e63-c363-422e-893f-d8dbcd05751a"></div>

<style>
.vega-embed svg, .vega-embed canvas {
  border: 1px dotted gray;
}

.vega-embed .vega-actions a {
  margin-right: 6px;
}
</style>

<p><a href="https://postimg.org/image/wsda3n23h/"><img src="https://s6.postimg.org/fruduyp29/output_25_2.png" alt="output_25_2.png" /></a></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">barley_Data</span> <span class="o">=</span> <span class="n">load_dataset</span><span class="p">(</span><span class="s">'barley'</span><span class="p">)</span>
<span class="n">barley_Data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div></div>

<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>site</th>
      <th>variety</th>
      <th>year</th>
      <th>yield</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>University Farm</td>
      <td>Manchuria</td>
      <td>1931</td>
      <td>27.00000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Waseca</td>
      <td>Manchuria</td>
      <td>1931</td>
      <td>48.86667</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Morris</td>
      <td>Manchuria</td>
      <td>1931</td>
      <td>27.43334</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Crookston</td>
      <td>Manchuria</td>
      <td>1931</td>
      <td>39.93333</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Grand Rapids</td>
      <td>Manchuria</td>
      <td>1931</td>
      <td>32.96667</td>
    </tr>
  </tbody>
</table>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Let me show you how Row and Column classes in the Encode channels work</span>
<span class="c"># This graph is to understand how response depends on a conditioned exploratory variable.</span>



<span class="s">'''
Questions to answer:Which site has which variety of Barley produce for the corresponding year
'''</span>

<span class="n">Chart</span><span class="p">(</span><span class="n">barley_Data</span><span class="p">)</span><span class="o">.</span><span class="n">mark_point</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">color</span><span class="o">=</span><span class="s">'year:N'</span><span class="p">,</span>
    <span class="n">row</span><span class="o">=</span><span class="s">'site:O'</span><span class="p">,</span>
    <span class="n">x</span><span class="o">=</span><span class="s">'mean(yield):Q'</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="n">Y</span><span class="p">(</span><span class="s">'variety:O'</span><span class="p">,</span>
        <span class="n">scale</span><span class="o">=</span><span class="n">Scale</span><span class="p">(</span>
            <span class="n">bandSize</span><span class="o">=</span><span class="mf">12.0</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="c">## variety is an ordinal field. We are using another field as sort definition object here</span>
        <span class="n">sort</span><span class="o">=</span><span class="n">SortField</span><span class="p">(</span>
            <span class="n">field</span><span class="o">=</span><span class="s">'yield'</span><span class="p">,</span>
            <span class="n">op</span><span class="o">=</span><span class="s">'mean'</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="p">)</span>
<span class="p">)</span>
</code></pre></div></div>

<div class="vega-embed" id="5bde9e5e-4f89-4481-9a7a-d95c7364e929"></div>

<style>
.vega-embed svg, .vega-embed canvas {
  border: 1px dotted gray;
}

.vega-embed .vega-actions a {
  margin-right: 6px;
}
</style>

<p><a href="https://postimg.org/image/x6em38m71/"><img src="https://s6.postimg.org/8pwg8rlgh/output_27_2.png" alt="output_27_2.png" /></a></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s">'''
Question to Answer: how much of yield have happened
                  in particular site for a particular variety each year?
'''</span>
<span class="n">Chart</span><span class="p">(</span><span class="n">barley_Data</span><span class="p">)</span><span class="o">.</span><span class="n">mark_bar</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">color</span><span class="o">=</span><span class="s">'site:N'</span><span class="p">,</span>
    <span class="n">column</span><span class="o">=</span><span class="s">'year:O'</span><span class="p">,</span>
    <span class="n">x</span><span class="o">=</span><span class="s">'sum(yield):Q'</span><span class="p">,</span> <span class="c">## According to vega documentation, We cannot change title of field names</span>
    <span class="c">## derived from transformation functions</span>
    <span class="n">y</span><span class="o">=</span><span class="s">'variety:N'</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div></div>

<div class="vega-embed" id="b118a6b5-6503-489a-b344-21d11d6034c5"></div>

<style>
.vega-embed svg, .vega-embed canvas {
  border: 1px dotted gray;
}

.vega-embed .vega-actions a {
  margin-right: 6px;
}
</style>

<p><a href="https://postimg.org/image/ocnpm4z8d/"><img src="https://s6.postimg.org/6mm113lnl/output_28_2.png" alt="output_28_2.png" /></a></p>

<h4 id="binning-and-aggregation">Binning and Aggregation</h4>

<p>This section introduces <strong>data transformation pipeline</strong> which embedded to the visualisation process. Binning is a process of grouping similar data. Aggregation is a process of applying a group function on the specific group. It follows the same concept as <a href="http://pandas.pydata.org/pandas-docs/stable/groupby.html">pandas</a>. Coming back to Cars dataset.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s">'''
Question to answer: How many cars are there with similar (mileage,horsepower)
'''</span>
<span class="kn">from</span> <span class="nn">altair</span>  <span class="kn">import</span> <span class="n">Size</span>
<span class="n">car_Chart</span> <span class="o">=</span> <span class="n">Chart</span><span class="p">(</span><span class="n">car_data</span><span class="p">)</span><span class="o">.</span><span class="n">mark_point</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">X</span><span class="p">(</span><span class="s">'Horsepower'</span><span class="p">,</span> <span class="nb">bin</span><span class="o">=</span><span class="bp">True</span><span class="p">),</span>
    <span class="n">Y</span><span class="p">(</span><span class="s">'Miles_per_Gallon'</span><span class="p">,</span> <span class="nb">bin</span><span class="o">=</span><span class="bp">True</span><span class="p">),</span>
    <span class="n">Size</span><span class="p">(</span><span class="s">'count(*):Q'</span><span class="p">),</span>
<span class="p">)</span>
<span class="n">car_Chart</span>
</code></pre></div></div>

<div class="vega-embed" id="a28c6ca0-7a7b-4a16-8de3-164e8db5b140"></div>

<style>
.vega-embed svg, .vega-embed canvas {
  border: 1px dotted gray;
}

.vega-embed .vega-actions a {
  margin-right: 6px;
}
</style>

<p><a href="https://postimg.org/image/4w2zzm44d/"><img src="https://s6.postimg.org/ete0sobq9/output_30_2.png" alt="output_30_2.png" /></a></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s">'''
Question to Answer: What is the average acceleration for those vehicles which has similar (mileage,horsepower)?
Does acceleration affect the mileage? Do vehicles with high horsepower accelerates faster? Do they consume
more fuel per mile?
'''</span>

<span class="n">car_Data</span> <span class="o">=</span> <span class="n">Chart</span><span class="p">(</span><span class="n">car_data</span><span class="p">)</span><span class="o">.</span><span class="n">mark_circle</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
   <span class="n">X</span><span class="p">(</span><span class="s">'Horsepower'</span><span class="p">,</span> <span class="nb">bin</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">title</span><span class="o">=</span><span class="s">'HorsePower'</span><span class="p">),</span>
    <span class="n">Y</span><span class="p">(</span><span class="s">'Miles_per_Gallon'</span><span class="p">,</span> <span class="nb">bin</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">title</span><span class="o">=</span><span class="s">'Miles per Gallon'</span><span class="p">),</span>
    <span class="n">size</span><span class="o">=</span><span class="s">'count(*):Q'</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="s">'average(Acceleration):Q'</span>
<span class="p">)</span>

<span class="n">car_Data</span>
</code></pre></div></div>

<div class="vega-embed" id="a9f67131-3e42-4120-8f05-3cdbf5d1f60c"></div>

<style>
.vega-embed svg, .vega-embed canvas {
  border: 1px dotted gray;
}

.vega-embed .vega-actions a {
  margin-right: 6px;
}
</style>

<p><a href="https://postimg.org/image/e5569qd0d/"><img src="https://s6.postimg.org/q70k3vm8x/output_31_2.png" alt="output_31_2.png" /></a></p>

<h4 id="data-transformations">Data Transformations</h4>
<p>One of the coolest feature in Altair is the transformation feature. Let me brief you the problem it solves.</p>

<p>We will take a US population dataset. I want to display the demographic dividend of last previous census year which is 2000. In Altair viz I can visualize this specific data without pre-processing my dataframe and crunching it to represent 2000 data.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">census_Data</span> <span class="o">=</span> <span class="n">load_dataset</span><span class="p">(</span><span class="s">'population'</span><span class="p">)</span>
<span class="n">census_Data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
<span class="c"># sex 1 = Male and 2= Female</span>
</code></pre></div></div>

<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>people</th>
      <th>sex</th>
      <th>year</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>1483789</td>
      <td>1</td>
      <td>1850</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>1450376</td>
      <td>2</td>
      <td>1850</td>
    </tr>
    <tr>
      <th>2</th>
      <td>5</td>
      <td>1411067</td>
      <td>1</td>
      <td>1850</td>
    </tr>
    <tr>
      <th>3</th>
      <td>5</td>
      <td>1359668</td>
      <td>2</td>
      <td>1850</td>
    </tr>
    <tr>
      <th>4</th>
      <td>10</td>
      <td>1260099</td>
      <td>1</td>
      <td>1850</td>
    </tr>
  </tbody>
</table>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">altair</span> <span class="kn">import</span> <span class="n">Formula</span>
<span class="n">color_range</span> <span class="o">=</span> <span class="n">Scale</span><span class="p">(</span><span class="nb">range</span><span class="o">=</span><span class="p">[</span><span class="s">'#B3E5FC'</span><span class="p">,</span><span class="s">'#0288D1'</span><span class="p">])</span>
<span class="n">male_or_female</span> <span class="o">=</span> <span class="n">Formula</span><span class="p">(</span><span class="n">field</span><span class="o">=</span><span class="s">'gender'</span><span class="p">,</span>
                       <span class="n">expr</span><span class="o">=</span><span class="s">'datum.sex == 1 ? "Male" : "Female"'</span><span class="p">)</span>
<span class="n">Chart</span><span class="p">(</span><span class="n">census_Data</span><span class="p">)</span><span class="o">.</span><span class="n">mark_bar</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="s">'age:O'</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="s">'mean(people):Q'</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="n">Color</span><span class="p">(</span><span class="s">'gender:N'</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">color_range</span><span class="p">)</span>
<span class="p">)</span><span class="o">.</span><span class="n">transform_data</span><span class="p">(</span>
    <span class="c"># inside transform_data we can set column names as attributes of datum.</span>
    <span class="nb">filter</span><span class="o">=</span><span class="s">'datum.year == 2000'</span><span class="p">,</span>
    <span class="n">calculate</span><span class="o">=</span><span class="p">[</span><span class="n">male_or_female</span><span class="p">],</span>
<span class="p">)</span>

<span class="c">## interpret the graph this way. of 18.5 M ppl between age 0 and 5 there are 10 M males</span>
<span class="c">## and around 8.5 Million female</span>
<span class="c">## Find a better representation below</span>
</code></pre></div></div>

<div class="vega-embed" id="0eff3a40-7dc1-45b6-8c95-7b5431d24ca4"></div>

<style>
.vega-embed svg, .vega-embed canvas {
  border: 1px dotted gray;
}

.vega-embed .vega-actions a {
  margin-right: 6px;
}
</style>

<p><a href="https://postimg.org/image/flgorvfx9/"><img src="https://s6.postimg.org/7fymtproh/output_34_2.png" alt="output_34_2.png" /></a></p>

<ul>
  <li>The <strong>filter</strong> attribute of transform_data() accepts a string of <strong>javascript code</strong>, referring to the data column name as an attribute of <strong>datum</strong>, which you can think of as the <strong>row</strong> within the dataset.</li>
  <li>The calculate`s attribute accepts a <strong>list of Formula objects</strong>, which each define a <strong>new column</strong> using an valid javascript expression over existing columns. In our case <strong>gender</strong> is a new column.</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">male_or_female</span> <span class="o">=</span> <span class="n">Formula</span><span class="p">(</span><span class="n">field</span><span class="o">=</span><span class="s">'gender'</span><span class="p">,</span>
                       <span class="n">expr</span><span class="o">=</span><span class="s">'datum.sex == 1 ? "Male" : "Female"'</span><span class="p">)</span>

<span class="n">Chart</span><span class="p">(</span><span class="n">census_Data</span><span class="p">)</span><span class="o">.</span><span class="n">mark_bar</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">color</span><span class="o">=</span><span class="n">Color</span><span class="p">(</span><span class="s">'gender:N'</span><span class="p">,</span>
        <span class="n">scale</span><span class="o">=</span><span class="n">Scale</span><span class="p">(</span>
            <span class="nb">range</span><span class="o">=</span><span class="p">[</span><span class="s">'#B3E5FC'</span><span class="p">,</span> <span class="s">'#0288D1'</span><span class="p">],</span>
        <span class="p">),</span>
    <span class="p">),</span>
    <span class="n">column</span><span class="o">=</span><span class="n">Column</span><span class="p">(</span><span class="s">'age:O'</span><span class="p">,</span>
        <span class="n">axis</span><span class="o">=</span><span class="n">Axis</span><span class="p">(</span>
            <span class="c"># orientation of Axis should be in the bottom</span>
            <span class="n">orient</span><span class="o">=</span><span class="s">'bottom'</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">),</span>
    <span class="n">x</span><span class="o">=</span><span class="n">X</span><span class="p">(</span><span class="s">'gender:N'</span><span class="p">,</span>
        <span class="n">axis</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
        <span class="n">scale</span><span class="o">=</span><span class="n">Scale</span><span class="p">(</span>
            <span class="c"># if you remove the bandSize Chart will enlarge</span>
            <span class="n">bandSize</span><span class="o">=</span><span class="mf">6.0</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">),</span>
    <span class="n">y</span><span class="o">=</span><span class="n">Y</span><span class="p">(</span><span class="s">'sum(people):Q'</span><span class="p">,</span>
        <span class="n">axis</span><span class="o">=</span><span class="n">Axis</span><span class="p">(</span>
            <span class="n">title</span><span class="o">=</span><span class="s">'population'</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">),</span>
<span class="p">)</span><span class="o">.</span><span class="n">transform_data</span><span class="p">(</span>
    <span class="n">calculate</span><span class="o">=</span><span class="p">[</span><span class="n">male_or_female</span><span class="p">],</span>
    <span class="nb">filter</span><span class="o">=</span><span class="s">'datum.year == 2000'</span><span class="p">,</span>
<span class="p">)</span><span class="o">.</span><span class="n">configure_facet_cell</span><span class="p">(</span>
    <span class="n">strokeWidth</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div></div>

<div class="vega-embed" id="fa4504fc-bb29-43f5-8023-5fab34a0c450"></div>

<style>
.vega-embed svg, .vega-embed canvas {
  border: 1px dotted gray;
}

.vega-embed .vega-actions a {
  margin-right: 6px;
}
</style>

<p><a href="https://postimg.org/image/nr3sn5ahp/"><img src="https://s6.postimg.org/wm4mxnza9/output_36_2.png" alt="output_36_2.png" /></a></p>

<h4 id="date-and-time-units">Date and Time units</h4>

<p>Many visualizing libraries are really bad at representing timeseries data. Lets see what Altair has to offer</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">seattle_data</span> <span class="o">=</span> <span class="n">load_dataset</span><span class="p">(</span><span class="s">'seattle-weather'</span><span class="p">)</span>
<span class="n">seattle_data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div></div>

<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>date</th>
      <th>precipitation</th>
      <th>temp_max</th>
      <th>temp_min</th>
      <th>wind</th>
      <th>weather</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2012/01/01</td>
      <td>0.0</td>
      <td>12.8</td>
      <td>5.0</td>
      <td>4.7</td>
      <td>drizzle</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2012/01/02</td>
      <td>10.9</td>
      <td>10.6</td>
      <td>2.8</td>
      <td>4.5</td>
      <td>rain</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2012/01/03</td>
      <td>0.8</td>
      <td>11.7</td>
      <td>7.2</td>
      <td>2.3</td>
      <td>rain</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2012/01/04</td>
      <td>20.3</td>
      <td>12.2</td>
      <td>5.6</td>
      <td>4.7</td>
      <td>rain</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2012/01/05</td>
      <td>1.3</td>
      <td>8.9</td>
      <td>2.8</td>
      <td>6.1</td>
      <td>rain</td>
    </tr>
  </tbody>
</table>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s">'''
Question to answer: Which months in seattle are warmest? Which are the coldest? over the years
'''</span>

<span class="n">temp_range</span> <span class="o">=</span> <span class="n">Formula</span><span class="p">(</span><span class="n">field</span><span class="o">=</span><span class="s">'temp_range'</span><span class="p">,</span>
                     <span class="n">expr</span><span class="o">=</span><span class="s">'datum.temp_max - datum.temp_min'</span><span class="p">)</span>


<span class="n">Chart</span><span class="p">(</span><span class="n">seattle_data</span><span class="p">)</span><span class="o">.</span><span class="n">mark_line</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">X</span><span class="p">(</span><span class="s">'date:T'</span><span class="p">,</span> <span class="n">timeUnit</span><span class="o">=</span><span class="s">'month'</span><span class="p">),</span>
    <span class="n">y</span><span class="o">=</span><span class="s">'mean(temp_range):Q'</span>
<span class="p">)</span><span class="o">.</span><span class="n">transform_data</span><span class="p">(</span>
    <span class="n">calculate</span><span class="o">=</span><span class="p">[</span><span class="n">temp_range</span><span class="p">],</span>
<span class="p">)</span>
</code></pre></div></div>

<div class="vega-embed" id="51d77556-72b4-4552-b927-d65c2822bda6"></div>

<style>
.vega-embed svg, .vega-embed canvas {
  border: 1px dotted gray;
}

.vega-embed .vega-actions a {
  margin-right: 6px;
}
</style>

<p><a href="https://postimg.org/image/ohwisxcv1/"><img src="https://s6.postimg.org/se9uowxup/output_39_2.png" alt="output_39_2.png" /></a></p>

<h1 id="conclusion">Conclusion</h1>

<p>So far, you have seen the most basic functionalities of Altair Viz. The developers are still working on the API and I am sure it is only going to get better.</p>

<p>Altair viz is definitely a constrained visualisation model. I personally like the way it seperates the statistical visualisation problem into understandable components.It will be most suitable to do exploratory data analysis over large datasets. It is also trying to converge usage of single data model which reduces the learning curve for developers. If you are really intereseted to learn more copy paste this code in a new cell and start playing around!</p>

<p><code class="highlighter-rouge">from altair import tutorial
tutorial()
</code></p>

<h2 id="references">References:</h2>

<p><a href="http://vega.github.io/vega-lite/docs/mark.html">vega-lite</a></p>

                    <hr>
                    <div class="row">
                        <div class="col-md-6">
                                <h5 style="display: inline;">Tags:</h5>
                                
                                    <button class="btn btn-white btn-xs" type="button">blog</button>
                                
                                    <button class="btn btn-white btn-xs" type="button">Data Science</button>
                                
                                    <button class="btn btn-white btn-xs" type="button">Visualization</button>
                                
                        </div>
                        <div class="col-md-6">
                            <div class="small text-right">
                                <h5>Stats:</h5>
                                <div> 
                                
                                <i class="fa fa-comments-o"> </i> <span class='disqus-comment-count' data-disqus-url="http://karthikBalasubramanian.github.io/ml/2017/01/20/AltairViz.html">0</span> comments
                                
                                </div>
                            </div>
                        </div> 
                    </div>
                    <br>
                    <!-- <div class="row">
                        <div class="col-lg-12">-->
                            <!-- donate -->
                            <!-- 
                            <br> -->
                            <!-- share -->
                            <!-- 
                            <br> -->
                            <!-- comment -->
                            


<div id="disqus_thread"></div>
<script>
/** * RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS. * LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables */
	/*
	var disqus_config = function () { this.page.url = PAGE_URL;
	// Replace PAGE_URL with your page's canonical URL variable this.page.identifier = PAGE_IDENTIFIER;
	// Replace PAGE_IDENTIFIER with your page's unique identifier variable };
	*/
	(function() { // DON'T EDIT BELOW THIS LINE
			var d = document, s = d.createElement('script');
			s.src = '//https-karthikbalasubramanian-github-io.disqus.com/embed.js';
			s.setAttribute('data-timestamp', +new Date());
			(d.head || d.body).appendChild(s);
		})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>

 
                        <!-- </div>
                    </div> -->

                </div>
            </div>
        </div>
    </div>

</div>


	
	    <script src="/static/js/scroll.js"></script>

<!-- Baidu analytics -->


<!-- Google analytics -->



  <script type="text/javascript">
    var disqusShortName = "https-karthikbalasubramanian-github-io";

    var disqusPublicKey = "N3n8ymxO3tzmAfetCxCQ6HTocyF7PMrvp1pzgkaRTNQkNKRxHnAUwxEixA86xNQv";

    var urlArray = [];
    $('.disqus-comment-count').each(function () {
      var url = $(this).attr('data-disqus-url');
      urlArray.push('link:' + url);
    });
    $.ajax({
      type: 'GET',
      url: "https://disqus.com/api/3.0/threads/set.jsonp",
      data: { api_key: disqusPublicKey, forum : disqusShortName, thread : urlArray },
      cache: false,
      dataType: "jsonp",
      success: function (result) {
        for (var i in result.response) {
          var count = result.response[i].posts;
          if ( count ) {
            $('.disqus-comment-count[data-disqus-url="' + result.response[i].link + '"]').html(count);
          }
        }
      }
    });
</script>




<script async src="/static/js/count.min.js"></script>

	

</body>
</html>